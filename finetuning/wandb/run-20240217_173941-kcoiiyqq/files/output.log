[rank: 0] Seed set to 11111
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
/ocean/projects/cis240002p/jhou/envs/mamba/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:2387: UserWarning: torch.distributed._all_gather_base is a private function and will be deprecated. Please use torch.distributed.all_gather_into_tensor instead.
  warnings.warn(
/ocean/projects/cis240002p/jhou/envs/mamba/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:2387: UserWarning: torch.distributed._all_gather_base is a private function and will be deprecated. Please use torch.distributed.all_gather_into_tensor instead.
  warnings.warn(
/ocean/projects/cis240002p/jhou/envs/mamba/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py:2387: UserWarning: torch.distributed._all_gather_base is a private function and will be deprecated. Please use torch.distributed.all_gather_into_tensor instead.
  warnings.warn(
Traceback (most recent call last):
  File "/ocean/projects/cis240002p/jhou/mamba/finetuning/main.py", line 253, in <module>
    fire.Fire(main)
  File "/ocean/projects/cis240002p/jhou/envs/mamba/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/ocean/projects/cis240002p/jhou/envs/mamba/lib/python3.10/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/ocean/projects/cis240002p/jhou/envs/mamba/lib/python3.10/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/ocean/projects/cis240002p/jhou/mamba/finetuning/main.py", line 217, in main
    train_chunk(
  File "/ocean/projects/cis240002p/jhou/mamba/finetuning/main.py", line 109, in train_chunk
    logits.reshape((-1, logits.size(-1))), labels.reshape(-1))
NameError: name 'labels' is not defined